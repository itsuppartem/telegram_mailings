# Telegram Mailing System

Система для управления массовыми рассылками через Telegram ботов, состоящая из двух микросервисов. Предназначена для работы с крупной аудиторией и поддержки рекламных акций.

## 1. Mailing Orchestration Service (`src/`)
- REST API для управления рассылками
- Создание и планирование рассылок с отложенным запуском
- Мониторинг и отчетность в реальном времени
- Веб-интерфейс для отслеживания статуса рассылок
- Управление API-ключами и аутентификацией
- Подробнее: [README.md](src/README.md)

## 2. Mailing Processor (`worker/`)
- Асинхронная обработка рассылок с использованием asyncio
- Многопроцессорная отправка сообщений для высокой производительности
- Интеграция с Telegram API с поддержкой нескольких ботов
- Управление статусами и автоматическая отчетность
- Обработка ошибок и повторные попытки отправки
- Подробнее: [README.md](worker/README.md)

## Технический стек
- Python 3.9+
- FastAPI для API и веб-интерфейса
- MongoDB для хранения данных о рассылках
- APScheduler для планирования задач
- asyncio для асинхронной обработки
- multiprocessing для параллельной отправки
- httpx для HTTP-запросов
- Pydantic для валидации данных

## Особенности
- Поддержка нескольких ботов (`ko` и `vroom`)
- Временные окна для отправки (time_spoon)
- Персональные промокоды для пользователей
- Отложенный запуск рассылок
- Сегментация аудитории по номерам телефонов
- Многопоточная обработка для высокой производительности
- Автоматическое возобновление рассылок
- Защита от превышения лимитов Telegram API

## Примечания
1. Система оптимизирована для работы с крупной аудиторией
2. Существует альтернативная версия с использованием RabbitMQ и Docker Compose для масштабирования воркеров, но требует доработки
3. Некоторые особенности (например, обработка потерь сообщений) согласованы с заказчиком и могут быть доработаны при необходимости
4. Система использует асинхронный подход для эффективной работы с I/O-операциями
5. Встроенная защита от блокировки со стороны Telegram API